---
title: "Authentication API"
description: "Complete guide to BoxLog authentication system. Learn how to implement secure API authentication and access control."
tags: ["authentication", "api", "security", "access-control"]
author: "BoxLog Team"
publishedAt: "2025-01-16"
updatedAt: "2025-01-16"
order: 1
featured: true
category: "api"
slug: "rest-authentication"
---

# Authentication API

YourSaaS provides a comprehensive authentication system that supports multiple authentication methods, session management, and fine-grained access control.

## Overview

The Authentication API allows you to:

- **User Registration & Login** - Create accounts and authenticate users
- **Session Management** - Handle user sessions securely
- **Multi-Factor Authentication** - Add extra security layers
- **Social Authentication** - Login with Google, GitHub, etc.
- **Role-Based Access Control** - Manage permissions and roles
- **Password Management** - Reset and update passwords securely

## Base URL

All authentication endpoints are available at:

```
https://api.yoursaas.com/v1/auth
```

## Authentication Methods

### API Key Authentication

Include your API key in the request headers:

```bash
curl -H "Authorization: Bearer YOUR_API_KEY" \
     -H "Content-Type: application/json" \
     https://api.yoursaas.com/v1/auth/me
```

### Session Authentication

For client-side applications, use session tokens:

```javascript
// Set session token after login
localStorage.setItem('yoursaas_token', sessionToken)

// Include in requests
fetch('/api/users', {
  headers: {
    'Authorization': `Bearer ${localStorage.getItem('yoursaas_token')}`
  }
})
```

## User Registration

### Create User Account

Create a new user account with email and password.

**Endpoint:** `POST /auth/register`

**Request Body:**

```typescript
interface RegisterRequest {
  email: string
  password: string
  name?: string
  metadata?: Record<string, any>
}
```

**Example Request:**

```bash
curl -X POST https://api.yoursaas.com/v1/auth/register \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "email": "user@example.com",
    "password": "securePassword123!",
    "name": "John Doe",
    "metadata": {
      "source": "website",
      "referrer": "google"
    }
  }'
```

**Response:**

```json
{
  "success": true,
  "data": {
    "user": {
      "id": "usr_1234567890",
      "email": "user@example.com",
      "name": "John Doe",
      "emailVerified": false,
      "createdAt": "2024-01-25T10:00:00Z",
      "updatedAt": "2024-01-25T10:00:00Z"
    },
    "session": {
      "token": "sess_abcdef123456",
      "expiresAt": "2024-01-26T10:00:00Z"
    }
  }
}
```

### Email Verification

Send email verification to newly registered users.

**Endpoint:** `POST /auth/verify-email`

```bash
curl -X POST https://api.yoursaas.com/v1/auth/verify-email \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "email": "user@example.com"
  }'
```

## User Login

### Email & Password Login

Authenticate users with email and password.

**Endpoint:** `POST /auth/login`

**Request Body:**

```typescript
interface LoginRequest {
  email: string
  password: string
  rememberMe?: boolean
}
```

**Example:**

```javascript
const response = await fetch('/api/auth/login', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer YOUR_API_KEY'
  },
  body: JSON.stringify({
    email: 'user@example.com',
    password: 'securePassword123!',
    rememberMe: true
  })
})

const { data } = await response.json()
const { user, session } = data
```

**Response:**

```json
{
  "success": true,
  "data": {
    "user": {
      "id": "usr_1234567890",
      "email": "user@example.com",
      "name": "John Doe",
      "emailVerified": true,
      "lastLoginAt": "2024-01-25T10:00:00Z"
    },
    "session": {
      "token": "sess_abcdef123456",
      "expiresAt": "2024-01-26T10:00:00Z"
    }
  }
}
```

### Magic Link Login

Send a passwordless login link via email.

**Endpoint:** `POST /auth/magic-link`

```bash
curl -X POST https://api.yoursaas.com/v1/auth/magic-link \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "email": "user@example.com",
    "redirectUrl": "https://yourapp.com/dashboard"
  }'
```

## Social Authentication

### Supported Providers

YourSaaS supports OAuth with multiple providers:

- **Google** - `google`
- **GitHub** - `github`
- **Microsoft** - `microsoft`
- **Facebook** - `facebook`
- **Twitter** - `twitter`
- **LinkedIn** - `linkedin`

### OAuth Flow

**Step 1: Get Authorization URL**

```bash
curl "https://api.yoursaas.com/v1/auth/oauth/google/authorize?redirect_uri=https://yourapp.com/callback"
```

**Response:**

```json
{
  "authorizationUrl": "https://accounts.google.com/oauth/authorize?client_id=...",
  "state": "random_state_string"
}
```

**Step 2: Handle Callback**

```javascript
// Handle the OAuth callback
const response = await fetch('/api/auth/oauth/google/callback', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer YOUR_API_KEY'
  },
  body: JSON.stringify({
    code: authorizationCode,
    state: stateFromStep1
  })
})
```

## Session Management

### Get Current User

Retrieve the currently authenticated user's information.

**Endpoint:** `GET /auth/me`

```typescript
// Using the SDK
const user = await client.auth.getCurrentUser()

// Direct API call
const response = await fetch('/api/auth/me', {
  headers: {
    'Authorization': `Bearer ${sessionToken}`
  }
})
```

**Response:**

```json
{
  "success": true,
  "data": {
    "user": {
      "id": "usr_1234567890",
      "email": "user@example.com",
      "name": "John Doe",
      "emailVerified": true,
      "role": "user",
      "permissions": ["read:profile", "write:profile"],
      "metadata": {}
    }
  }
}
```

### Refresh Session

Extend or refresh an existing session.

**Endpoint:** `POST /auth/refresh`

```bash
curl -X POST https://api.yoursaas.com/v1/auth/refresh \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer CURRENT_SESSION_TOKEN"
```

### Logout

Invalidate the current session.

**Endpoint:** `POST /auth/logout`

```javascript
await fetch('/api/auth/logout', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${sessionToken}`
  }
})

// Clear local session
localStorage.removeItem('yoursaas_token')
```

## Multi-Factor Authentication (MFA)

### Enable MFA

**Endpoint:** `POST /auth/mfa/enable`

```bash
curl -X POST https://api.yoursaas.com/v1/auth/mfa/enable \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer SESSION_TOKEN" \
  -d '{
    "method": "totp"
  }'
```

**Response:**

```json
{
  "success": true,
  "data": {
    "qrCode": "data:image/png;base64,iVBORw0KGgoAAAANSU...",
    "secret": "JBSWY3DPEHPK3PXP",
    "backupCodes": [
      "123456789",
      "987654321"
    ]
  }
}
```

### Verify MFA

**Endpoint:** `POST /auth/mfa/verify`

```bash
curl -X POST https://api.yoursaas.com/v1/auth/mfa/verify \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer SESSION_TOKEN" \
  -d '{
    "code": "123456"
  }'
```

## Password Management

### Change Password

**Endpoint:** `PUT /auth/password`

```bash
curl -X PUT https://api.yoursaas.com/v1/auth/password \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer SESSION_TOKEN" \
  -d '{
    "currentPassword": "oldPassword123!",
    "newPassword": "newSecurePassword456!"
  }'
```

### Reset Password

**Step 1: Request Reset**

```bash
curl -X POST https://api.yoursaas.com/v1/auth/password/reset \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "email": "user@example.com"
  }'
```

**Step 2: Confirm Reset**

```bash
curl -X POST https://api.yoursaas.com/v1/auth/password/reset/confirm \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "token": "reset_token_from_email",
    "newPassword": "newSecurePassword789!"
  }'
```

## Role-Based Access Control (RBAC)

### Assign Role

**Endpoint:** `PUT /auth/users/{userId}/role`

```bash
curl -X PUT https://api.yoursaas.com/v1/auth/users/usr_1234567890/role \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "role": "admin"
  }'
```

### Check Permissions

```javascript
// Using the SDK
const hasPermission = await client.auth.hasPermission('write:users')

// In middleware
if (!user.permissions.includes('admin:users')) {
  return res.status(403).json({ error: 'Insufficient permissions' })
}
```

## SDK Examples

### React Hook

```typescript
import { useAuth } from '@yoursaas/react'

function LoginForm() {
  const { login, logout, user, isLoading } = useAuth()

  const handleLogin = async (email: string, password: string) => {
    try {
      await login({ email, password })
    } catch (error) {
      console.error('Login failed:', error)
    }
  }

  if (isLoading) return <div>Loading...</div>
  if (user) return <div>Welcome, {user.name}!</div>

  return (
    <form onSubmit={(e) => {
      e.preventDefault()
      const formData = new FormData(e.target)
      handleLogin(
        formData.get('email'),
        formData.get('password')
      )
    }}>
      <input name="email" type="email" required />
      <input name="password" type="password" required />
      <button type="submit">Login</button>
    </form>
  )
}
```

### Next.js Middleware

```typescript
// middleware.ts
import { NextRequest, NextResponse } from 'next/server'
import { verifySession } from '@yoursaas/nextjs'

export async function middleware(request: NextRequest) {
  const token = request.cookies.get('session')?.value
  
  if (!token) {
    return NextResponse.redirect(new URL('/login', request.url))
  }

  try {
    const user = await verifySession(token)
    
    // Add user info to headers
    const response = NextResponse.next()
    response.headers.set('x-user-id', user.id)
    response.headers.set('x-user-role', user.role)
    
    return response
  } catch (error) {
    return NextResponse.redirect(new URL('/login', request.url))
  }
}

export const config = {
  matcher: ['/dashboard/:path*', '/api/protected/:path*']
}
```

## Error Handling

### Common Error Codes

| Code | Description | HTTP Status |
|------|-------------|-------------|
| `AUTH_INVALID_CREDENTIALS` | Invalid email or password | 401 |
| `AUTH_USER_NOT_FOUND` | User does not exist | 404 |
| `AUTH_EMAIL_NOT_VERIFIED` | Email verification required | 403 |
| `AUTH_ACCOUNT_LOCKED` | Account temporarily locked | 423 |
| `AUTH_MFA_REQUIRED` | Multi-factor authentication required | 403 |
| `AUTH_INVALID_TOKEN` | Session token invalid or expired | 401 |
| `AUTH_INSUFFICIENT_PERMISSIONS` | User lacks required permissions | 403 |

### Error Response Format

```json
{
  "success": false,
  "error": {
    "code": "AUTH_INVALID_CREDENTIALS",
    "message": "Invalid email or password",
    "details": {
      "field": "password",
      "attemptCount": 3,
      "lockoutTime": "2024-01-25T10:15:00Z"
    }
  }
}
```

## Rate Limiting

Authentication endpoints are rate limited to prevent abuse:

- **Login attempts**: 5 per minute per IP
- **Registration**: 3 per minute per IP  
- **Password reset**: 2 per hour per email
- **Email verification**: 3 per hour per email

Rate limit headers are included in responses:

```
X-RateLimit-Limit: 5
X-RateLimit-Remaining: 3
X-RateLimit-Reset: 1642248000
```

## Security Best Practices

### Password Requirements

- Minimum 8 characters
- At least one uppercase letter
- At least one lowercase letter  
- At least one number
- At least one special character
- Cannot be a common password

### Session Security

- Sessions expire after 24 hours by default
- Use HTTPS in production
- Implement proper CSRF protection
- Store session tokens securely (httpOnly cookies recommended)

### API Key Security

- Never expose API keys in client-side code
- Use environment variables
- Rotate keys regularly
- Use different keys for different environments

## Next Steps

- **[User Management API](/docs/api-reference/users)** - Manage user profiles and data
- **[Organizations API](/docs/api-reference/organizations)** - Handle team and organization features
- **[Webhooks](/docs/api-reference/webhooks)** - React to authentication events
- **[Security Guide](/docs/guides/security)** - Advanced security practices