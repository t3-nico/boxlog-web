---
title: "Complete Guide to Building SaaS Applications with Next.js 14"
description: "Learn how to build scalable SaaS applications using Next.js 14's latest features. Comprehensive coverage from App Router and Server Components to authentication system implementation."
publishedAt: "2024-01-15"
updatedAt: "2024-01-20"
tags: ["Next.js", "React", "SaaS", "TypeScript", "Development", "Full Stack"]
category: "Technology"
author: "Takeshi Yamada"
authorAvatar: "/avatars/takeshi-yamada.jpg"
coverImage: "https://images.unsplash.com/photo-1555066931-4365d14bab8c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80"
featured: true
draft: false
---

# Complete Guide to Building SaaS Applications with Next.js 14

Next.js 14 provides numerous innovative features for SaaS application development. This article details how to build production-ready SaaS applications with specific code examples.

## Why Next.js 14?

Next.js 14 is ideal for SaaS development for the following reasons:

- **App Router**: New routing system with more intuitive file structure
- **Server Components**: Faster performance through server-side component rendering
- **Streaming**: Improved UX with progressive page loading
- **TypeScript Integration**: Type-safe development environment
- **Vercel Integration**: Easy deployment and scaling

## Project Setup

First, create a Next.js 14 project:

```bash
npx create-next-app@latest my-saas-app --typescript --tailwind --eslint --app
cd my-saas-app
```

Install necessary packages:

```bash
npm install next-auth prisma @prisma/client stripe @stripe/stripe-js
npm install -D @types/bcryptjs bcryptjs
```

## Authentication System Implementation

Let's implement the authentication system that forms the foundation of SaaS applications.

### NextAuth.js Configuration

```typescript
// app/api/auth/[...nextauth]/route.ts
import NextAuth from 'next-auth'
import CredentialsProvider from 'next-auth/providers/credentials'
import GoogleProvider from 'next-auth/providers/google'
import bcrypt from 'bcryptjs'
import { prisma } from '@/lib/prisma'

const handler = NextAuth({
  providers: [
    CredentialsProvider({
      name: 'credentials',
      credentials: {
        email: { label: 'Email', type: 'email' },
        password: { label: 'Password', type: 'password' }
      },
      async authorize(credentials) {
        if (!credentials?.email || !credentials?.password) {
          return null
        }

        const user = await prisma.user.findUnique({
          where: { email: credentials.email }
        })

        if (!user || !await bcrypt.compare(credentials.password, user.password)) {
          return null
        }

        return {
          id: user.id,
          email: user.email,
          name: user.name,
        }
      }
    }),
    GoogleProvider({
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
    })
  ],
  session: {
    strategy: 'jwt'
  },
  callbacks: {
    async jwt({ token, user }) {
      if (user) {
        token.id = user.id
      }
      return token
    },
    async session({ session, token }) {
      if (token.id) {
        session.user.id = token.id as string
      }
      return session
    }
  }
})

export { handler as GET, handler as POST }
```

### Database Schema

Define user model using Prisma:

```prisma
// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  password  String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  // SaaS related
  subscription Subscription?
  
  @@map("users")
}

model Subscription {
  id                String   @id @default(cuid())
  userId            String   @unique
  stripeCustomerId  String?  @unique
  stripePriceId     String?
  stripeCurrentPeriodEnd DateTime?
  
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("subscriptions")
}
```

## Page Structure Using App Router

Create efficient page structure using Next.js 14's App Router.

### Dashboard Layout

```tsx
// app/(dashboard)/layout.tsx
import { getServerSession } from 'next-auth'
import { redirect } from 'next/navigation'
import { Sidebar } from '@/components/dashboard/Sidebar'
import { Header } from '@/components/dashboard/Header'

export default async function DashboardLayout({
  children,
}: {
  children: React.ReactNode
}) {
  const session = await getServerSession()
  
  if (!session) {
    redirect('/auth/signin')
  }

  return (
    <div className="flex h-screen bg-gray-100">
      <Sidebar />
      <div className="flex-1 flex flex-col overflow-hidden">
        <Header user={session.user} />
        <main className="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100">
          <div className="container mx-auto px-6 py-8">
            {children}
          </div>
        </main>
      </div>
    </div>
  )
}
```

### Server Componentsの活用

```tsx
// app/(dashboard)/dashboard/page.tsx
import { getServerSession } from 'next-auth'
import { prisma } from '@/lib/prisma'
import { DashboardStats } from '@/components/dashboard/DashboardStats'
import { RecentActivity } from '@/components/dashboard/RecentActivity'

async function getDashboardData(userId: string) {
  const user = await prisma.user.findUnique({
    where: { id: userId },
    include: {
      subscription: true,
    }
  })
  
  return user
}

export default async function DashboardPage() {
  const session = await getServerSession()
  const userData = await getDashboardData(session!.user.id)
  
  return (
    <div className="space-y-8">
      <div>
        <h1 className="text-3xl font-bold text-gray-900">
          Dashboard
        </h1>
        <p className="mt-2 text-gray-600">
          Welcome, {userData?.name}
        </p>
      </div>
      
      <DashboardStats user={userData} />
      <RecentActivity userId={session!.user.id} />
    </div>
  )
}
```

## Stripe Payment System Integration

Implement Stripe payment system essential for SaaS monetization.

### Stripe Configuration

```typescript
// lib/stripe.ts
import Stripe from 'stripe'

export const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!, {
  apiVersion: '2023-10-16',
})

export const getStripeSession = async ({
  priceId,
  domainUrl,
  customerId,
}: {
  priceId: string
  domainUrl: string
  customerId?: string
}) => {
  const session = await stripe.checkout.sessions.create({
    customer: customerId,
    payment_method_types: ['card'],
    billing_address_collection: 'required',
    line_items: [
      {
        price: priceId,
        quantity: 1,
      },
    ],
    mode: 'subscription',
    allow_promotion_codes: true,
    success_url: `${domainUrl}/dashboard?session_id={CHECKOUT_SESSION_ID}`,
    cancel_url: `${domainUrl}/pricing`,
  })

  return session
}
```

### Payment Page Implementation

```tsx
// app/pricing/page.tsx
import { PricingCard } from '@/components/pricing/PricingCard'

const pricingPlans = [
  {
    name: 'Starter',
    price: '$9.99',
    priceId: 'price_starter_monthly',
    features: [
      'Projects: Up to 3',
      'Storage: 1GB',
      'Email support'
    ]
  },
  {
    name: 'Pro',
    price: '$29.99',
    priceId: 'price_pro_monthly',
    features: [
      'Projects: Unlimited',
      'Storage: 10GB',
      'Priority support',
      'Advanced analytics'
    ]
  }
]

export default function PricingPage() {
  return (
    <div className="py-12">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="text-center">
          <h2 className="text-3xl font-extrabold text-gray-900 sm:text-4xl">
            Simple and transparent pricing plans
          </h2>
        </div>
        
        <div className="mt-12 space-y-4 sm:mt-16 sm:space-y-0 sm:grid sm:grid-cols-2 sm:gap-6 lg:max-w-4xl lg:mx-auto">
          {pricingPlans.map((plan) => (
            <PricingCard key={plan.name} plan={plan} />
          ))}
        </div>
      </div>
    </div>
  )
}
```

## Performance Optimization Best Practices

### 1. Image Optimization

```tsx
import Image from 'next/image'

export function ProductImage({ src, alt }: { src: string; alt: string }) {
  return (
    <Image
      src={src}
      alt={alt}
      width={300}
      height={200}
      priority
      placeholder="blur"
      blurDataURL="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQ..."
    />
  )
}
```

### 2. Dynamic Import

```tsx
import dynamic from 'next/dynamic'

const Analytics = dynamic(() => import('@/components/Analytics'), {
  ssr: false,
  loading: () => <div>Loading analytics data...</div>
})
```

### 3. Suspense and Streaming

```tsx
import { Suspense } from 'react'

export default function DashboardPage() {
  return (
    <div>
      <h1>Dashboard</h1>
      <Suspense fallback={<div>Loading statistics...</div>}>
        <DashboardStats />
      </Suspense>
      <Suspense fallback={<div>Loading activity...</div>}>
        <RecentActivity />
      </Suspense>
    </div>
  )
}
```

## Security Measures

### CSRF Protection

```typescript
// middleware.ts
import { NextResponse } from 'next/server'
import type { NextRequest } from 'next/server'

export function middleware(request: NextRequest) {
  const response = NextResponse.next()
  
  // CSRF token configuration
  if (request.method === 'POST') {
    const token = request.headers.get('x-csrf-token')
    // Token validation logic
  }
  
  return response
}
```

### Rate Limiting

```typescript
// lib/rate-limit.ts
import { Redis } from '@upstash/redis'

const redis = Redis.fromEnv()

export async function rateLimit(identifier: string) {
  const result = await redis.incr(identifier)
  
  if (result === 1) {
    await redis.expire(identifier, 60) // 1 minute
  }
  
  return result <= 10 // Up to 10 times per minute
}
```

## Test Implementation

### Unit Tests

```typescript
// __tests__/auth.test.ts
import { describe, expect, it } from '@jest/globals'
import { validateEmail } from '@/lib/validation'

describe('Authentication', () => {
  it('should validate email correctly', () => {
    expect(validateEmail('test@example.com')).toBe(true)
    expect(validateEmail('invalid-email')).toBe(false)
  })
})
```

### E2E Tests

```typescript
// e2e/auth.spec.ts
import { test, expect } from '@playwright/test'

test('user can sign up and sign in', async ({ page }) => {
  await page.goto('/auth/signup')
  
  await page.fill('[data-testid=email]', 'test@example.com')
  await page.fill('[data-testid=password]', 'password123')
  await page.click('[data-testid=submit]')
  
  await expect(page).toHaveURL('/dashboard')
})
```

## Deployment and Operations

### Vercel Deployment

```bash
# Environment variable setup
vercel env add DATABASE_URL
vercel env add NEXTAUTH_SECRET
vercel env add STRIPE_SECRET_KEY

# Deploy
vercel --prod
```

### Monitoring and Logging

```typescript
// lib/logger.ts
import { createLogger, format, transports } from 'winston'

export const logger = createLogger({
  level: 'info',
  format: format.combine(
    format.timestamp(),
    format.errors({ stack: true }),
    format.json()
  ),
  transports: [
    new transports.File({ filename: 'error.log', level: 'error' }),
    new transports.File({ filename: 'combined.log' })
  ]
})
```

## Conclusion

When developing SaaS applications with Next.js 14, the following points are crucial:

1. **App Router** for efficient routing
2. **Server Components** for performance optimization
3. **NextAuth.js** for robust authentication systems
4. **Stripe** for payment systems
5. Thorough **security measures**
6. **Testing** implementation for quality assurance

By combining these elements, you can build scalable and maintainable SaaS applications. Continue improving and incorporating user feedback to create valuable products.

<Callout type="info">
  Before using the code introduced in this article in actual production environments, please conduct proper testing and security reviews.
</Callout>

## Related Resources

- [Next.js 14 Official Documentation](https://nextjs.org/docs)
- [NextAuth.js Guide](https://next-auth.js.org/)
- [Stripe Payment Guide](https://stripe.com/docs)
- [Prisma Database Toolkit](https://www.prisma.io/docs)